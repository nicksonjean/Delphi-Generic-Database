unit Unit1;

interface

uses
  System.SysUtils,
  System.Types,
  System.UITypes,
  System.Classes,
  System.Variants,
  System.Rtti,
  System.Bindings.Outputs,
  System.StrUtils,

  FMX.Types,
  FMX.Controls,
  FMX.Forms,
  FMX.Graphics,
  FMX.Dialogs,
  FMX.Controls.Presentation,
  FMX.StdCtrls,
  FMX.TabControl,
  FMX.Bind.Editors,
  FMX.Grid.Style,
  FMX.ScrollBox,
  FMX.Grid,
  FMX.Bind.DBEngExt,
  FMX.Bind.Grid,
  FMX.ExtCtrls,
  FMX.ListBox,
  FMX.ComboEdit,
  FMX.Layouts,
  FMX.Edit,
  FMX.ListView.Types,
  FMX.ListView.Appearances,
  FMX.ListView.Adapters.Base,
  FMX.ListView,
  FMX.Objects,
  FMX.SearchBox,

  ArrayClass,
  SQLConnection,
  QueryComponent, FMX.Memo;

type
  TSQLConnectionTester = class(TForm)
    TabControl: TTabControl;
    TabSQLConnection: TTabItem;
    TabDataTypes: TTabItem;
    TabControlSQLConnection: TTabControl;
    TabDBSQLite: TTabItem;
    GroupBoxComponentsSQLite: TGroupBox;
    GridPanelLayoutSQLite: TGridPanelLayout;
    LabelComboBoxSQLite: TLabel;
    LabelComboEditSQLite: TLabel;
    ComboBoxSQLite: TComboBox;
    ComboEditSQLite: TComboEdit;
    LabelListBoxSQLite: TLabel;
    LabelListViewSQLite: TLabel;
    ListBoxSQLite: TListBox;
    ListViewSQLite: TListView;
    LabelStringGridSQLite: TLabel;
    LabelGridSQLite: TLabel;
    StringGridSQLite: TStringGrid;
    GridSQLite: TGrid;
    TabDBFirebird: TTabItem;
    GroupBoxComponentsFirebird: TGroupBox;
    GridPanelLayoutFirebird: TGridPanelLayout;
    LabelComboBoxFirebird: TLabel;
    LabelComboEditFirebird: TLabel;
    ComboEditFirebird: TComboEdit;
    LabelListBoxFirebird: TLabel;
    LabelListViewFirebird: TLabel;
    LabelStringGridFirebird: TLabel;
    LabelGridFirebird: TLabel;
    ComboBoxFirebird: TComboBox;
    ListBoxFirebird: TListBox;
    ListViewFirebird: TListView;
    StringGridFirebird: TStringGrid;
    GridFirebird: TGrid;
    TabDBMySQL: TTabItem;
    GroupBoxComponentsMySQL: TGroupBox;
    GridPanelLayoutMySQL: TGridPanelLayout;
    LabelComboBoxMySQL: TLabel;
    LabelComboEditMySQL: TLabel;
    ComboEditMySQL: TComboEdit;
    LabelListBoxMySQL: TLabel;
    LabelListViewMySQL: TLabel;
    LabelStringGridMySQL: TLabel;
    LabelGridMySQL: TLabel;
    ComboBoxMySQL: TComboBox;
    ListBoxMySQL: TListBox;
    ListViewMySQL: TListView;
    StringGridMySQL: TStringGrid;
    GridMySQL: TGrid;
    TabDBPostgreSQL: TTabItem;
    GroupBoxComponentsPostgreSQL: TGroupBox;
    GridPanelLayoutPostgreSQL: TGridPanelLayout;
    LabelComboBoxPostgreSQL: TLabel;
    LabelComboEditPostgreSQL: TLabel;
    ComboEditPostgreSQL: TComboEdit;
    LabelListBoxPostgreSQL: TLabel;
    LabelListViewPostgreSQL: TLabel;
    LabelStringGridPostgreSQL: TLabel;
    LabelGridPostgreSQL: TLabel;
    ComboBoxPostgreSQL: TComboBox;
    ListBoxPostgreSQL: TListBox;
    ListViewPostgreSQL: TListView;
    StringGridPostgreSQL: TStringGrid;
    GridPostgreSQL: TGrid;
    SearchBox1: TSearchBox;
    SearchBox2: TSearchBox;
    SearchBox3: TSearchBox;
    SearchBox4: TSearchBox;
    TabQueryBuilder: TTabItem;
    TabControlDataTypes: TTabControl;
    TabStrings: TTabItem;
    TabFloats: TTabItem;
    TabDateTime: TTabItem;
    TabArrays: TTabItem;
    GroupBox1: TGroupBox;
    GridPanelLayout1: TGridPanelLayout;
    Label1: TLabel;
    Label3: TLabel;
    Label5: TLabel;
    ComboBox1: TComboBox;
    ComboBox2: TComboBox;
    ComboBox3: TComboBox;
    GridPanelLayout2: TGridPanelLayout;
    ButToStr: TButton;
    ButInsert: TButton;
    ButUpdate: TButton;
    ButDelete: TButton;
    ButFetch: TButton;
    ButReplace: TButton;
    ButUpsert: TButton;
    GridPanelLayout3: TGridPanelLayout;
    ButClone: TButton;
    ButCopy: TButton;
    GroupBoxDataTypeArray: TGroupBox;
    GridPanelLayoutDataTypeArray: TGridPanelLayout;
    LabelDataTypeArray: TLabel;
    LabelDataTypeArrayVariant: TLabel;
    LabelDataTypeArrayField: TLabel;
    ComboBoxDataTypeTArray: TComboBox;
    ComboBoxDataTypeTArrayVariant: TComboBox;
    ComboBoxDataTypeTArrayField: TComboBox;
    Memo1: TMemo;
    Memo2: TMemo;
    procedure ButInsertClick(Sender: TObject);
    procedure ButUpdateClick(Sender: TObject);
    procedure ButDeleteClick(Sender: TObject);
    procedure ButReplaceClick(Sender: TObject);
    procedure ButUpsertClick(Sender: TObject);
    procedure ButToStrClick(Sender: TObject);
    procedure ButFetchClick(Sender: TObject);
    procedure ButCloneClick(Sender: TObject);
    procedure ButCopyClick(Sender: TObject);
    procedure TabDBSQLiteClick(Sender: TObject);
    procedure TabDBFirebirdClick(Sender: TObject);
    procedure TabDBMySQLClick(Sender: TObject);
    procedure TabDBPostgreSQLClick(Sender: TObject);
    { Private declarations }
  public
    { Public declarations }
    procedure DataTypeArrayTest(Sender : TObject);

  end;

var
  SQLConnectionTester: TSQLConnectionTester;

implementation

{$R *.fmx}

procedure TSQLConnectionTester.ButFetchClick(Sender: TObject);
var
  DB: TConnection;
  Dados1 : TArray;
  Query1: TQueryBuilder;
  Dados2 : TArrayVariant;
  Query2: TQueryBuilder;
begin
  DB := TConnection.Create;
  //DB := TConnectionClass.GetInstance();
  try
    DB.Driver := MYSQL;
    DB.Host := '127.0.0.1';
    DB.Port := 3306;
    DB.Database := 'simapp_dev_000';
    DB.Username := 'root';
    DB.Password := '';

    if not DB.GetInstance.Connection.Connected then
      DB.GetInstance.Connection.Connected := True;

    Dados1 := TArray.Create;
    try
      Dados1.Clear;
      Query1.Fetch('SELECT * FROM app_empresa', Dados1);
      ShowMessage(Dados1['arquivo_imagem_raw']);
    finally
      FreeAndNil(Dados1);
    end;

    Dados2 := TArrayVariant.Create;
    try
      Dados2.Clear;
      Query2.Fetch('SELECT * FROM app_empresa', Dados2);
      ShowMessage(Dados2['arquivo_imagem_raw']);
    finally
      FreeAndNil(Dados2);
    end;

  finally
    FreeAndNil(DB);
  end;
end;

procedure TSQLConnectionTester.ButToStrClick(Sender: TObject);
var
  DB: TConnection;
  Dados1 : TArray;
  Query1: TQueryBuilder;
  SQL1: TQuery;
  Dados2 : TArrayVariant;
  Query2: TQueryBuilder;
  SQL2: TQuery;
begin
  DB := TConnection.Create;
  //DB := TConnectionClass.GetInstance();
  try
    DB.Driver := MYSQL;
    DB.Host := '127.0.0.1';
    DB.Port := 3306;
    DB.Database := 'simapp_dev_000';
    DB.Username := 'root';
    DB.Password := '';

    if not DB.GetInstance.Connection.Connected then
      DB.GetInstance.Connection.Connected := True;

    Dados1 := TArray.Create;
    SQL1 := TQuery.Create();
    try
      Dados1.Clear;
      SQL1 := Query1.View('SELECT * FROM app_empresa');
      Dados1['id'] := SQL1.Query.FieldByName('id').Value;
      Dados1['tipo_pessoa'] := SQL1.Query.FieldByName('tipo_pessoa').Value;
      Dados1['tipo_documento'] := SQL1.Query.FieldByName('tipo_documento').Value;
      Dados1['tipo_estabelecimento'] := SQL1.Query.FieldByName('tipo_estabelecimento').Value;
      Dados1['regime_tributario'] := SQL1.Query.FieldByName('regime_tributario').Value;
      Dados1['documento_cadastral'] := SQL1.Query.FieldByName('documento_cadastral').Value;
      Dados1['inscricao_estadual'] := SQL1.Query.FieldByName('inscricao_estadual').Value;
      Dados1['inscricao_municipal'] := SQL1.Query.FieldByName('inscricao_municipal').Value;
      Dados1['razao_social'] := SQL1.Query.FieldByName('razao_social').Value;
      Dados1['nome_fantasia'] := SQL1.Query.FieldByName('nome_fantasia').Value;
      Dados1['cnae_principal_id'] := SQL1.Query.FieldByName('cnae_principal_id').Value;
      Dados1['arquivo_imagem_url'] := SQL1.Query.FieldByName('arquivo_imagem_url').Value;
      Dados1['arquivo_imagem_raw'] := SQL1.Query.FieldByName('arquivo_imagem_raw').Value;
      Dados1['endereco'] := SQL1.Query.FieldByName('endereco').Value;
      Dados1['contato'] := SQL1.Query.FieldByName('contato').Value;
      Dados1['email'] := SQL1.Query.FieldByName('email').Value;
      Dados1['sincronizado'] := SQL1.Query.FieldByName('sincronizado').Value;
      Dados1['data_insercao'] := SQL1.Query.FieldByName('data_insercao').Value;
      Dados1['data_edicao'] := SQL1.Query.FieldByName('data_edicao').Value;
      Showmessage(Dados1.ToList);
    finally
      FreeAndNil(Dados1);
      FreeAndNil(SQL1);
    end;

    Dados2 := TArrayVariant.Create;
    SQL2 := TQuery.Create();
    try
      Dados2.Clear;
      SQL2 := Query2.View('SELECT * FROM app_empresa');
      Dados2['id'] := SQL2.Query.FieldByName('id').Value;
      Dados2['tipo_pessoa'] := SQL2.Query.FieldByName('tipo_pessoa').Value;
      Dados2['tipo_documento'] := SQL2.Query.FieldByName('tipo_documento').Value;
      Dados2['tipo_estabelecimento'] := SQL2.Query.FieldByName('tipo_estabelecimento').Value;
      Dados2['regime_tributario'] := SQL2.Query.FieldByName('regime_tributario').Value;
      Dados2['documento_cadastral'] := SQL2.Query.FieldByName('documento_cadastral').Value;
      Dados2['inscricao_estadual'] := SQL2.Query.FieldByName('inscricao_estadual').Value;
      Dados2['inscricao_municipal'] := SQL2.Query.FieldByName('inscricao_municipal').Value;
      Dados2['razao_social'] := SQL2.Query.FieldByName('razao_social').Value;
      Dados2['nome_fantasia'] := SQL2.Query.FieldByName('nome_fantasia').Value;
      Dados2['cnae_principal_id'] := SQL2.Query.FieldByName('cnae_principal_id').Value;
      Dados2['arquivo_imagem_url'] := SQL2.Query.FieldByName('arquivo_imagem_url').Value;
      Dados2['arquivo_imagem_raw'] := SQL2.Query.FieldByName('arquivo_imagem_raw').Value;
      Dados2['endereco'] := SQL2.Query.FieldByName('endereco').Value;
      Dados2['contato'] := SQL2.Query.FieldByName('contato').Value;
      Dados2['email'] := SQL2.Query.FieldByName('email').Value;
      Dados2['sincronizado'] := SQL2.Query.FieldByName('sincronizado').Value;
      Dados2['data_insercao'] := SQL2.Query.FieldByName('data_insercao').Value;
      Dados2['data_edicao'] := SQL2.Query.FieldByName('data_edicao').Value;
      Showmessage(Dados2.ToList);
    finally
      FreeAndNil(Dados2);
      FreeAndNil(SQL2);
    end;

  finally
    FreeAndNil(DB);
  end;
end;

procedure TSQLConnectionTester.ButUpsertClick(Sender: TObject);
var
  DB: TConnection;
  Dados1 : TArray;
  Query1: TQueryBuilder;
  SQL1: TQuery;
  Dados2 : TArrayVariant;
  Query2: TQueryBuilder;
  SQL2: TQuery;
begin
  DB := TConnection.Create;
  //DB := TConnectionClass.GetInstance();
  try
    DB.Driver := MYSQL;
    DB.Host := '127.0.0.1';
    DB.Port := 3306;
    DB.Database := 'simapp_dev_000';
    DB.Username := 'root';
    DB.Password := '';

    if not DB.GetInstance.Connection.Connected then
      DB.GetInstance.Connection.Connected := True;

    Dados1 := TArray.Create;
    SQL1 := TQuery.Create();
    try
      Dados1.Clear;
      SQL1 := Query1.View('SELECT * FROM app_empresa');
      Dados1['id'] := SQL1.Query.FieldByName('id').Value;
      Dados1['tipo_pessoa'] := SQL1.Query.FieldByName('tipo_pessoa').Value;
      Dados1['tipo_documento'] := SQL1.Query.FieldByName('tipo_documento').Value;
      Dados1['tipo_estabelecimento'] := SQL1.Query.FieldByName('tipo_estabelecimento').Value;
      Dados1['regime_tributario'] := SQL1.Query.FieldByName('regime_tributario').Value;
      Dados1['documento_cadastral'] := SQL1.Query.FieldByName('documento_cadastral').Value;
      Dados1['inscricao_estadual'] := SQL1.Query.FieldByName('inscricao_estadual').Value;
      Dados1['inscricao_municipal'] := SQL1.Query.FieldByName('inscricao_municipal').Value;
      Dados1['razao_social'] := SQL1.Query.FieldByName('razao_social').Value;
      Dados1['nome_fantasia'] := SQL1.Query.FieldByName('nome_fantasia').Value;
      Dados1['cnae_principal_id'] := SQL1.Query.FieldByName('cnae_principal_id').Value;
      Dados1['arquivo_imagem_url'] := SQL1.Query.FieldByName('arquivo_imagem_url').Value;
      Dados1['arquivo_imagem_raw'] := SQL1.Query.FieldByName('arquivo_imagem_raw').Value;
      Dados1['endereco'] := SQL1.Query.FieldByName('endereco').Value;
      Dados1['contato'] := SQL1.Query.FieldByName('contato').Value;
      Dados1['email'] := SQL1.Query.FieldByName('email').Value;
      Dados1['sincronizado'] := SQL1.Query.FieldByName('sincronizado').Value;
      Dados1['data_insercao'] := SQL1.Query.FieldByName('data_insercao').Value;
      Dados1['data_edicao'] := SQL1.Query.FieldByName('data_edicao').Value;
      Showmessage(Query1.Upsert('app_empresa', Dados1, False, False, False));
      Showmessage(Query1.Upsert('app_empresa', Dados1, False, False, True));
    finally
      FreeAndNil(Dados1);
      FreeAndNil(SQL1);
    end;

    Dados2 := TArrayVariant.Create;
    SQL2 := TQuery.Create();
    try
      Dados2.Clear;
      SQL2 := Query2.View('SELECT * FROM app_empresa');
      Dados2['id'] := SQL2.Query.FieldByName('id').Value;
      Dados2['tipo_pessoa'] := SQL2.Query.FieldByName('tipo_pessoa').Value;
      Dados2['tipo_documento'] := SQL2.Query.FieldByName('tipo_documento').Value;
      Dados2['tipo_estabelecimento'] := SQL2.Query.FieldByName('tipo_estabelecimento').Value;
      Dados2['regime_tributario'] := SQL2.Query.FieldByName('regime_tributario').Value;
      Dados2['documento_cadastral'] := SQL2.Query.FieldByName('documento_cadastral').Value;
      Dados2['inscricao_estadual'] := SQL2.Query.FieldByName('inscricao_estadual').Value;
      Dados2['inscricao_municipal'] := SQL2.Query.FieldByName('inscricao_municipal').Value;
      Dados2['razao_social'] := SQL2.Query.FieldByName('razao_social').Value;
      Dados2['nome_fantasia'] := SQL2.Query.FieldByName('nome_fantasia').Value;
      Dados2['cnae_principal_id'] := SQL2.Query.FieldByName('cnae_principal_id').Value;
      Dados2['arquivo_imagem_url'] := SQL2.Query.FieldByName('arquivo_imagem_url').Value;
      Dados2['arquivo_imagem_raw'] := SQL2.Query.FieldByName('arquivo_imagem_raw').Value;
      Dados2['endereco'] := SQL2.Query.FieldByName('endereco').Value;
      Dados2['contato'] := SQL2.Query.FieldByName('contato').Value;
      Dados2['email'] := SQL2.Query.FieldByName('email').Value;
      Dados2['sincronizado'] := SQL2.Query.FieldByName('sincronizado').Value;
      Dados2['data_insercao'] := SQL2.Query.FieldByName('data_insercao').Value;
      Dados2['data_edicao'] := SQL2.Query.FieldByName('data_edicao').Value;
      Showmessage(Query2.Upsert('app_empresa', Dados2, False, False, False));
      Showmessage(Query2.Upsert('app_empresa', Dados2, False, False, True));
    finally
      FreeAndNil(Dados2);
      FreeAndNil(SQL2);
    end;

  finally
    FreeAndNil(DB);
  end;
end;

procedure TSQLConnectionTester.DataTypeArrayTest(Sender: TObject);
begin
  case AnsiIndexStr(TComboBox(Sender).Selected.Text, ['Fetch','ToList','ToTags','ToXML','ToJSON','ToYAML','Copy','Clone']) of
    0 : showmessage(TComboBox(Sender).Selected.Text);
    1 : showmessage(TComboBox(Sender).Selected.Text);
    2 : showmessage(TComboBox(Sender).Selected.Text);
    3 : showmessage(TComboBox(Sender).Selected.Text);
    4 : showmessage(TComboBox(Sender).Selected.Text);
    5 : showmessage(TComboBox(Sender).Selected.Text);
    6 : showmessage(TComboBox(Sender).Selected.Text);
    7 : showmessage(TComboBox(Sender).Selected.Text);
  end;
end;

procedure TSQLConnectionTester.TabDBFirebirdClick(Sender: TObject);
var
  DBFirebird : TConnection;
  SQL: TQuery;
  Query: TQueryBuilder;
  Component: TQueryComponent;
begin
  DBFirebird := TConnection.Create;
  //DBFirebird := TConnectionClass.GetInstance();
  try
    DBFirebird.Driver := FIREBIRD;
    DBFirebird.Host := '127.0.0.1';
    DBFirebird.Port := 3050;
    DBFirebird.Database :=
    {$IFDEF MSWINDOWS}
      ExtractFilePath(ParamStr(0)) + 'DB.FDB';
    {$ELSE}
      TPath.Combine(TPath.GetDocumentsPath, 'DB.FDB');
    {$ENDIF}
    DBFirebird.Username := 'SYSDBA';
    DBFirebird.Password := 'masterkey';

    if not DBFirebird.GetInstance.Connection.Connected then
      DBFirebird.GetInstance.Connection.Connected := True;

    SQL := TQuery.Create;
    try
      SQL := Query.View('SELECT "id" AS "Codigo", "nome" AS "Estado", "sigla" AS "Sigla" FROM "estado" ORDER BY "id"');

      Component := TQueryComponent.Create(SQL);
      try
        Component := TQueryComponent.Create(SQL);
        Component.ToCombo(ComboBoxFirebird, 'Codigo', 'Estado', 1);
        Component.ToCombo(ComboEditFirebird, 'Codigo', 'Estado', 2);
        Component.ToListBox(ListBoxFirebird, 'Codigo', 'Estado', 3);
//        Component.ToGrid(GridFirebird);
//        Component.ToGrid(StringGridFirebird);
//        Component.ToListView(ListViewFirebird, 'Codigo', 'Estado', 'Sigla', 'Sigla', 'Sigla');
      finally
        FreeAndNil(Component);
      end;

    finally
      FreeAndNil(SQL);
    end;

  finally
    FreeAndNil(DBFirebird);
  end;
end;

procedure TSQLConnectionTester.TabDBMySQLClick(Sender: TObject);
var
  DBMySQL : TConnection;
  SQL: TQuery;
  Query: TQueryBuilder;
  Component: TQueryComponent;
begin
  DBMySQL := TConnection.Create;
  //DBMySQL := TConnectionClass.GetInstance();
  try
    DBMySQL.Driver := MYSQL;
    DBMySQL.Host := '127.0.0.1';
    DBMySQL.Port := 3306;
    DBMySQL.Database := 'demodev';
    DBMySQL.Username := 'root';
    DBMySQL.Password := '';

    if not DBMySQL.GetInstance.Connection.Connected then
      DBMySQL.GetInstance.Connection.Connected := True;

    SQL := TQuery.Create;
    try
      SQL := Query.View('SELECT id AS Codigo, nome AS Estado, sigla AS Sigla FROM estado ORDER BY id');

      Component := TQueryComponent.Create(SQL);
      try
        Component := TQueryComponent.Create(SQL);
        Component.ToCombo(ComboBoxMySQL, 'Codigo', 'Estado', 1);
        Component.ToCombo(ComboEditMySQL, 'Codigo', 'Estado', 2);
        Component.ToListBox(ListBoxMySQL, 'Codigo', 'Estado', 3);
//        Component.ToGrid(GridMySQL);
//        Component.ToGrid(StringGridMySQL);
//        Component.ToListView(ListViewMySQL, 'Codigo', 'Estado', 'Sigla', 'Sigla', 'Sigla');
      finally
        FreeAndNil(Component);
      end;

    finally
      FreeAndNil(SQL);
    end;

  finally
    FreeAndNil(DBMySQL);
  end;
end;

procedure TSQLConnectionTester.TabDBPostgreSQLClick(Sender: TObject);
var
  DBPostgreSQL : TConnection;
  SQL: TQuery;
  Query: TQueryBuilder;
  Component : TQueryComponent;
begin
  DBPostgreSQL := TConnection.Create;
  //DBPostgreSQL := TConnectionClass.GetInstance();
  try
    DBPostgreSQL.Driver := POSTGRES;
    DBPostgreSQL.Host := '127.0.0.1';
    DBPostgreSQL.Port := 5432;
    DBPostgreSQL.Database := 'demodev';
    DBPostgreSQL.Schema := 'demodev';
    DBPostgreSQL.Username := 'postgres';
    DBPostgreSQL.Password := 'masterkey';

    if not DBPostgreSQL.GetInstance.Connection.Connected then
      DBPostgreSQL.GetInstance.Connection.Connected := True;

    SQL := TQuery.Create;
    try
      SQL := Query.View('SELECT "id" AS "Codigo", "nome" AS "Estado", "sigla" AS "Sigla" FROM "estado" ORDER BY "id"');

      Component := TQueryComponent.Create(SQL);
      try
        Component := TQueryComponent.Create(SQL);
        Component.ToCombo(ComboBoxPostgreSQL, 'Codigo', 'Estado', 1);
        Component.ToCombo(ComboEditPostgreSQL, 'Codigo', 'Estado', 2);
        Component.ToListBox(ListBoxPostgreSQL, 'Codigo', 'Estado', 3);
//        Component.ToGrid(GridPostgreSQL);
//        Component.ToGrid(StringGridPostgreSQL);
//        Component.ToListView(ListViewPostgreSQL, 'Codigo', 'Estado', 'Sigla', 'Sigla', 'Sigla');
      finally
        FreeAndNil(Component);
      end;

    finally
      FreeAndNil(SQL);
    end;

  finally
    FreeAndNil(DBPostgreSQL);
  end;
end;

procedure TSQLConnectionTester.TabDBSQLiteClick(Sender: TObject);
var
  DBSQLite : TConnection;
  SQL: TQuery;
  Query: TQueryBuilder;
  Component: TQueryComponent;
begin
  DBSQLite := TConnection.Create;
  //DBSQLite := TConnectionClass.GetInstance();
  try
    DBSQLite.Driver := SQLITE;
    DBSQLite.Database :=
    {$IFDEF MSWINDOWS}
      ExtractFilePath(ParamStr(0)) + 'DB.SQLITE';
    {$ELSE}
      TPath.Combine(TPath.GetDocumentsPath, 'DB.SQLITE');
    {$ENDIF}

    if not DBSQLite.GetInstance.Connection.Connected then
      DBSQLite.GetInstance.Connection.Connected := True;

    SQL := TQuery.Create;
    try
      SQL := Query.View('SELECT id AS Codigo, nome AS Estado, sigla AS Sigla FROM estado ORDER BY id');

      Component := TQueryComponent.Create(SQL);
      try
        Component.ToCombo(ComboBoxSQLite, 'Codigo', 'Estado', 1);
        Component.ToCombo(ComboEditSQLite, 'Codigo', 'Estado', 2);
        Component.ToListBox(ListBoxSQLite, 'Codigo', 'Estado', 3);
//        Component.ToGrid(GridSQLite);
//        Component.ToGrid(StringGridSQLite);
//        Component.ToListView(ListViewSQLite, 'Codigo', 'Estado', 'Sigla', 'Sigla', 'Sigla');
      finally
        FreeAndNil(Component);
      end;

    finally
      FreeAndNil(SQL);
    end;

  finally
    FreeAndNil(DBSQLite);
  end;
end;

procedure TSQLConnectionTester.ButReplaceClick(Sender: TObject);
var
  DB: TConnection;
  Dados1, Filtros1 : TArray;
  Query1: TQueryBuilder;
  SQL1: TQuery;
  Dados2, Filtros2 : TArrayVariant;
  Query2: TQueryBuilder;
  SQL2: TQuery;
begin
  DB := TConnection.Create;
  //DB := TConnectionClass.GetInstance();
  try
    DB.Driver := MYSQL;
    DB.Host := '127.0.0.1';
    DB.Port := 3306;
    DB.Database := 'simapp_dev_000';
    DB.Username := 'root';
    DB.Password := '';

    if not DB.GetInstance.Connection.Connected then
      DB.GetInstance.Connection.Connected := True;

    Dados1 := TArray.Create;
    Filtros1 := TArray.Create;
    SQL1 := TQuery.Create();
    try
      Dados1.Clear;
      SQL1 := Query1.View('SELECT * FROM app_empresa');
      Dados1['id'] := SQL1.Query.FieldByName('id').Value;
      Dados1['tipo_pessoa'] := SQL1.Query.FieldByName('tipo_pessoa').Value;
      Dados1['tipo_documento'] := SQL1.Query.FieldByName('tipo_documento').Value;
      Dados1['tipo_estabelecimento'] := SQL1.Query.FieldByName('tipo_estabelecimento').Value;
      Dados1['regime_tributario'] := SQL1.Query.FieldByName('regime_tributario').Value;
      Dados1['documento_cadastral'] := SQL1.Query.FieldByName('documento_cadastral').Value;
      Dados1['inscricao_estadual'] := SQL1.Query.FieldByName('inscricao_estadual').Value;
      Dados1['inscricao_municipal'] := SQL1.Query.FieldByName('inscricao_municipal').Value;
      Dados1['razao_social'] := SQL1.Query.FieldByName('razao_social').Value;
      Dados1['nome_fantasia'] := SQL1.Query.FieldByName('nome_fantasia').Value;
      Dados1['cnae_principal_id'] := SQL1.Query.FieldByName('cnae_principal_id').Value;
      Dados1['arquivo_imagem_url'] := SQL1.Query.FieldByName('arquivo_imagem_url').Value;
      Dados1['arquivo_imagem_raw'] := SQL1.Query.FieldByName('arquivo_imagem_raw').Value;
      Dados1['endereco'] := SQL1.Query.FieldByName('endereco').Value;
      Dados1['contato'] := SQL1.Query.FieldByName('contato').Value;
      Dados1['email'] := SQL1.Query.FieldByName('email').Value;
      Dados1['sincronizado'] := SQL1.Query.FieldByName('sincronizado').Value;
      Dados1['data_insercao'] := SQL1.Query.FieldByName('data_insercao').Value;
      Dados1['data_edicao'] := SQL1.Query.FieldByName('data_edicao').Value;
      Showmessage(Query1.Replace('app_empresa', Dados1));
      Filtros1.Clear;
      Filtros1['id ='] := '1';
      Showmessage(Query1.Replace('app_empresa', Dados1, Filtros1));
    finally
      FreeAndNil(Filtros1);
      FreeAndNil(Dados1);
      FreeAndNil(SQL1);
    end;

    Filtros2 := TArrayVariant.Create;
    Dados2 := TArrayVariant.Create;
    SQL2 := TQuery.Create();
    try
      Dados2.Clear;
      SQL2 := Query2.View('SELECT * FROM app_empresa');
      Dados2['id'] := SQL2.Query.FieldByName('id').Value;
      Dados2['tipo_pessoa'] := SQL2.Query.FieldByName('tipo_pessoa').Value;
      Dados2['tipo_documento'] := SQL2.Query.FieldByName('tipo_documento').Value;
      Dados2['tipo_estabelecimento'] := SQL2.Query.FieldByName('tipo_estabelecimento').Value;
      Dados2['regime_tributario'] := SQL2.Query.FieldByName('regime_tributario').Value;
      Dados2['documento_cadastral'] := SQL2.Query.FieldByName('documento_cadastral').Value;
      Dados2['inscricao_estadual'] := SQL2.Query.FieldByName('inscricao_estadual').Value;
      Dados2['inscricao_municipal'] := SQL2.Query.FieldByName('inscricao_municipal').Value;
      Dados2['razao_social'] := SQL2.Query.FieldByName('razao_social').Value;
      Dados2['nome_fantasia'] := SQL2.Query.FieldByName('nome_fantasia').Value;
      Dados2['cnae_principal_id'] := SQL2.Query.FieldByName('cnae_principal_id').Value;
      Dados2['arquivo_imagem_url'] := SQL2.Query.FieldByName('arquivo_imagem_url').Value;
      Dados2['arquivo_imagem_raw'] := SQL2.Query.FieldByName('arquivo_imagem_raw').Value;
      Dados2['endereco'] := SQL2.Query.FieldByName('endereco').Value;
      Dados2['contato'] := SQL2.Query.FieldByName('contato').Value;
      Dados2['email'] := SQL2.Query.FieldByName('email').Value;
      Dados2['sincronizado'] := SQL2.Query.FieldByName('sincronizado').Value;
      Dados2['data_insercao'] := SQL2.Query.FieldByName('data_insercao').Value;
      Dados2['data_edicao'] := SQL2.Query.FieldByName('data_edicao').Value;
      Showmessage(Query2.Replace('app_empresa', Dados2));
      Filtros2.Clear;
      Filtros2['id ='] := '1';
      Showmessage(Query2.Replace('app_empresa', Dados2, Filtros2));
    finally
      FreeAndNil(Filtros2);
      FreeAndNil(Dados2);
      FreeAndNil(SQL2);
    end;

  finally
    FreeAndNil(DB);
  end;
end;

procedure TSQLConnectionTester.ButCopyClick(Sender: TObject);
var
  DB: TConnection;
  Dados1 : TArrayVariant;
  Query1: TQueryBuilder;
  SQL1: TQuery;

  Dados2 : TArrayVariant;
begin
  DB := TConnection.Create;
  //DB := TConnectionClass.GetInstance();
  try
    DB.Driver := MYSQL;
    DB.Host := '127.0.0.1';
    DB.Port := 3306;
    DB.Database := 'simapp_dev_000';
    DB.Username := 'root';
    DB.Password := '';

    if not DB.GetInstance.Connection.Connected then
      DB.GetInstance.Connection.Connected := True;

    Dados1 := TArrayVariant.Create;
    SQL1 := TQuery.Create();
    try
      Dados1.Clear;
      SQL1 := Query1.View('SELECT * FROM app_empresa');
      Dados1['id'] := SQL1.Query.FieldByName('id').Value;
      Dados1['tipo_pessoa'] := SQL1.Query.FieldByName('tipo_pessoa').Value;
      Dados1['tipo_documento'] := SQL1.Query.FieldByName('tipo_documento').Value;
      Dados1['tipo_estabelecimento'] := SQL1.Query.FieldByName('tipo_estabelecimento').Value;
      Dados1['regime_tributario'] := SQL1.Query.FieldByName('regime_tributario').Value;
      Dados1['documento_cadastral'] := SQL1.Query.FieldByName('documento_cadastral').Value;
      Dados1['inscricao_estadual'] := SQL1.Query.FieldByName('inscricao_estadual').Value;
      Dados1['inscricao_municipal'] := SQL1.Query.FieldByName('inscricao_municipal').Value;
      Dados1['razao_social'] := SQL1.Query.FieldByName('razao_social').Value;
      Dados1['nome_fantasia'] := SQL1.Query.FieldByName('nome_fantasia').Value;
      Dados1['cnae_principal_id'] := SQL1.Query.FieldByName('cnae_principal_id').Value;
      Dados1['arquivo_imagem_url'] := SQL1.Query.FieldByName('arquivo_imagem_url').Value;
      Dados1['arquivo_imagem_raw'] := SQL1.Query.FieldByName('arquivo_imagem_raw').Value;
      Dados1['endereco'] := SQL1.Query.FieldByName('endereco').Value;
      Dados1['contato'] := SQL1.Query.FieldByName('contato').Value;
      Dados1['email'] := SQL1.Query.FieldByName('email').Value;
      Dados1['sincronizado'] := SQL1.Query.FieldByName('sincronizado').Value;
      Dados1['data_insercao'] := SQL1.Query.FieldByName('data_insercao').Value;
      Dados1['data_edicao'] := SQL1.Query.FieldByName('data_edicao').Value;
      ShowMessage(Dados1['arquivo_imagem_raw']);
      Dados2 := TArrayVariant.Create(Dados1);
      ShowMessage(Dados2['arquivo_imagem_raw']);
    finally
      FreeAndNil(Dados1);
      FreeAndNil(SQL1);
      FreeAndNil(Dados2);
    end;

  finally
    FreeAndNil(DB);
  end;
end;

procedure TSQLConnectionTester.ButCloneClick(Sender: TObject);
var
  DB: TConnection;
  Dados1 : TArrayVariant;
  Query1: TQueryBuilder;
  Dados2 : TArrayVariant;
begin
  DB := TConnection.Create;
  //DB := TConnectionClass.GetInstance();
  try
    DB.Driver := MYSQL;
    DB.Host := '127.0.0.1';
    DB.Port := 3306;
    DB.Database := 'simapp_dev_000';
    DB.Username := 'root';
    DB.Password := '';

    if not DB.GetInstance.Connection.Connected then
      DB.GetInstance.Connection.Connected := True;

    Dados1 := TArrayVariant.Create;

    try
      Dados1.Clear;
      Query1.Fetch('SELECT * FROM app_empresa', Dados1);
      ShowMessage(Dados1['arquivo_imagem_raw']);

      Dados2 := TArrayVariant.Create(Dados1);
      ShowMessage(Dados2['arquivo_imagem_raw']);
    finally
      FreeAndNil(Dados1);
      FreeAndNil(Dados2);
    end;

  finally
    FreeAndNil(DB);
  end;
end;

procedure TSQLConnectionTester.ButDeleteClick(Sender: TObject);
var
  DB: TConnection;
  Filtros1: TArray;
  Query1: TQueryBuilder;
  Filtros2 : TArrayVariant;
  Query2: TQueryBuilder;
begin
  DB := TConnection.Create;
  //DB := TConnectionClass.GetInstance();
  try
    DB.Driver := MYSQL;
    DB.Host := '127.0.0.1';
    DB.Port := 3306;
    DB.Database := 'simapp_dev_000';
    DB.Username := 'root';
    DB.Password := '';

    if not DB.GetInstance.Connection.Connected then
      DB.GetInstance.Connection.Connected := True;

    //Delete Genérico
    Showmessage(Query1.Delete('app_empresa'));

    Filtros1 := TArray.Create;
    try
      Filtros1.Clear;
      Filtros1['id ='] := '1';
      Showmessage(Query1.Delete('app_empresa', Filtros1));
    finally
      FreeAndNil(Filtros1);
    end;

    Filtros2 := TArrayVariant.Create;
    try
      Filtros2.Clear;
      Filtros2['id ='] := '1';
      Showmessage(Query2.Delete('app_empresa', Filtros2));
    finally
      FreeAndNil(Filtros1);
    end;

  finally
    FreeAndNil(DB);
  end;
end;

procedure TSQLConnectionTester.ButUpdateClick(Sender: TObject);
var
  DB: TConnection;
  Dados1, Filtros1: TArray;
  Query1: TQueryBuilder;
  SQL1: TQuery;
  Dados2, Filtros2 : TArrayVariant;
  Query2: TQueryBuilder;
  SQL2: TQuery;
begin
  DB := TConnection.Create;
  //DB := TConnectionClass.GetInstance();
  try
    DB.Driver := MYSQL;
    DB.Host := '127.0.0.1';
    DB.Port := 3306;
    DB.Database := 'simapp_dev_000';
    DB.Username := 'root';
    DB.Password := '';

    if not DB.GetInstance.Connection.Connected then
      DB.GetInstance.Connection.Connected := True;

    Dados1 := TArray.Create;
    Filtros1 := TArray.Create;
    SQL1 := TQuery.Create();
    try
      Dados1.Clear;
      SQL1 := Query1.View('SELECT * FROM app_empresa');
      Dados1['id'] := SQL1.Query.FieldByName('id').Value;
      Dados1['tipo_pessoa'] := SQL1.Query.FieldByName('tipo_pessoa').Value;
      Dados1['tipo_documento'] := SQL1.Query.FieldByName('tipo_documento').Value;
      Dados1['tipo_estabelecimento'] := SQL1.Query.FieldByName('tipo_estabelecimento').Value;
      Dados1['regime_tributario'] := SQL1.Query.FieldByName('regime_tributario').Value;
      Dados1['documento_cadastral'] := SQL1.Query.FieldByName('documento_cadastral').Value;
      Dados1['inscricao_estadual'] := SQL1.Query.FieldByName('inscricao_estadual').Value;
      Dados1['inscricao_municipal'] := SQL1.Query.FieldByName('inscricao_municipal').Value;
      Dados1['razao_social'] := SQL1.Query.FieldByName('razao_social').Value;
      Dados1['nome_fantasia'] := SQL1.Query.FieldByName('nome_fantasia').Value;
      Dados1['cnae_principal_id'] := SQL1.Query.FieldByName('cnae_principal_id').Value;
      Dados1['arquivo_imagem_url'] := SQL1.Query.FieldByName('arquivo_imagem_url').Value;
      Dados1['arquivo_imagem_raw'] := SQL1.Query.FieldByName('arquivo_imagem_raw').Value;
      Dados1['endereco'] := SQL1.Query.FieldByName('endereco').Value;
      Dados1['contato'] := SQL1.Query.FieldByName('contato').Value;
      Dados1['email'] := SQL1.Query.FieldByName('email').Value;
      Dados1['sincronizado'] := SQL1.Query.FieldByName('sincronizado').Value;
      Dados1['data_insercao'] := SQL1.Query.FieldByName('data_insercao').Value;
      Dados1['data_edicao'] := SQL1.Query.FieldByName('data_edicao').Value;
      Showmessage(Query1.Update('app_empresa', Dados1));
      Filtros1.Clear;
      Filtros1['id ='] := '1';
      Showmessage(Query1.Update('app_empresa', Dados1, Filtros1));
    finally
      FreeAndNil(Filtros1);
      FreeAndNil(Dados1);
      FreeAndNil(SQL1);
    end;

    Dados2 := TArrayVariant.Create;
    Filtros2 := TArrayVariant.Create;
    SQL2 := TQuery.Create();
    try
      Dados2.Clear;
      SQL2 := Query2.View('SELECT * FROM app_empresa');
      Dados2['id'] := SQL2.Query.FieldByName('id').Value;
      Dados2['tipo_pessoa'] := SQL2.Query.FieldByName('tipo_pessoa').Value;
      Dados2['tipo_documento'] := SQL2.Query.FieldByName('tipo_documento').Value;
      Dados2['tipo_estabelecimento'] := SQL2.Query.FieldByName('tipo_estabelecimento').Value;
      Dados2['regime_tributario'] := SQL2.Query.FieldByName('regime_tributario').Value;
      Dados2['documento_cadastral'] := SQL2.Query.FieldByName('documento_cadastral').Value;
      Dados2['inscricao_estadual'] := SQL2.Query.FieldByName('inscricao_estadual').Value;
      Dados2['inscricao_municipal'] := SQL2.Query.FieldByName('inscricao_municipal').Value;
      Dados2['razao_social'] := SQL2.Query.FieldByName('razao_social').Value;
      Dados2['nome_fantasia'] := SQL2.Query.FieldByName('nome_fantasia').Value;
      Dados2['cnae_principal_id'] := SQL2.Query.FieldByName('cnae_principal_id').Value;
      Dados2['arquivo_imagem_url'] := SQL2.Query.FieldByName('arquivo_imagem_url').Value;
      Dados2['arquivo_imagem_raw'] := SQL2.Query.FieldByName('arquivo_imagem_raw').Value;
      Dados2['endereco'] := SQL2.Query.FieldByName('endereco').Value;
      Dados2['contato'] := SQL2.Query.FieldByName('contato').Value;
      Dados2['email'] := SQL2.Query.FieldByName('email').Value;
      Dados2['sincronizado'] := SQL2.Query.FieldByName('sincronizado').Value;
      Dados2['data_insercao'] := SQL2.Query.FieldByName('data_insercao').Value;
      Dados2['data_edicao'] := SQL2.Query.FieldByName('data_edicao').Value;
      Showmessage(Query2.Update('app_empresa', Dados2));
      Filtros2.Clear;
      Filtros2['id ='] := '1';
      Showmessage(Query2.Update('app_empresa', Dados2, Filtros2));
    finally
      FreeAndNil(Filtros2);
      FreeAndNil(Dados2);
      FreeAndNil(SQL2);
    end;

  finally
    FreeAndNil(DB);
  end;
end;

procedure TSQLConnectionTester.ButInsertClick(Sender: TObject);
var
  DB: TConnection;
  Dados1 : TArray;
  Query1: TQueryBuilder;
  SQL1: TQuery;
  Dados2 : TArrayVariant;
  Query2: TQueryBuilder;
  SQL2: TQuery;
begin
  DB := TConnection.Create;
  //DB := TConnectionClass.GetInstance();
  try
    DB.Driver := MYSQL;
    DB.Host := '127.0.0.1';
    DB.Port := 3306;
    DB.Database := 'simapp_dev_000';
    DB.Username := 'root';
    DB.Password := '';

    if not DB.GetInstance.Connection.Connected then
      DB.GetInstance.Connection.Connected := True;

    Dados1 := TArray.Create;
    SQL1 := TQuery.Create();
    try
      Dados1.Clear;
      SQL1 := Query1.View('SELECT * FROM app_empresa');
      Dados1['id'] := SQL1.Query.FieldByName('id').Value;
      Dados1['tipo_pessoa'] := SQL1.Query.FieldByName('tipo_pessoa').Value;
      Dados1['tipo_documento'] := SQL1.Query.FieldByName('tipo_documento').Value;
      Dados1['tipo_estabelecimento'] := SQL1.Query.FieldByName('tipo_estabelecimento').Value;
      Dados1['regime_tributario'] := SQL1.Query.FieldByName('regime_tributario').Value;
      Dados1['documento_cadastral'] := SQL1.Query.FieldByName('documento_cadastral').Value;
      Dados1['inscricao_estadual'] := SQL1.Query.FieldByName('inscricao_estadual').Value;
      Dados1['inscricao_municipal'] := SQL1.Query.FieldByName('inscricao_municipal').Value;
      Dados1['razao_social'] := SQL1.Query.FieldByName('razao_social').Value;
      Dados1['nome_fantasia'] := SQL1.Query.FieldByName('nome_fantasia').Value;
      Dados1['cnae_principal_id'] := SQL1.Query.FieldByName('cnae_principal_id').Value;
      Dados1['arquivo_imagem_url'] := SQL1.Query.FieldByName('arquivo_imagem_url').Value;
      Dados1['arquivo_imagem_raw'] := SQL1.Query.FieldByName('arquivo_imagem_raw').Value;
      Dados1['endereco'] := SQL1.Query.FieldByName('endereco').Value;
      Dados1['contato'] := SQL1.Query.FieldByName('contato').Value;
      Dados1['email'] := SQL1.Query.FieldByName('email').Value;
      Dados1['sincronizado'] := SQL1.Query.FieldByName('sincronizado').Value;
      Dados1['data_insercao'] := SQL1.Query.FieldByName('data_insercao').Value;
      Dados1['data_edicao'] := SQL1.Query.FieldByName('data_edicao').Value;
      Showmessage(Query1.Insert('app_empresa', Dados1));
    finally
      FreeAndNil(Dados1);
      FreeAndNil(SQL1);
    end;

    Dados2 := TArrayVariant.Create;
    SQL2 := TQuery.Create();
    try
      Dados2.Clear;
      SQL2 := Query2.View('SELECT * FROM app_empresa');
      Dados2['id'] := SQL2.Query.FieldByName('id').Value;
      Dados2['tipo_pessoa'] := SQL2.Query.FieldByName('tipo_pessoa').Value;
      Dados2['tipo_documento'] := SQL2.Query.FieldByName('tipo_documento').Value;
      Dados2['tipo_estabelecimento'] := SQL2.Query.FieldByName('tipo_estabelecimento').Value;
      Dados2['regime_tributario'] := SQL2.Query.FieldByName('regime_tributario').Value;
      Dados2['documento_cadastral'] := SQL2.Query.FieldByName('documento_cadastral').Value;
      Dados2['inscricao_estadual'] := SQL2.Query.FieldByName('inscricao_estadual').Value;
      Dados2['inscricao_municipal'] := SQL2.Query.FieldByName('inscricao_municipal').Value;
      Dados2['razao_social'] := SQL2.Query.FieldByName('razao_social').Value;
      Dados2['nome_fantasia'] := SQL2.Query.FieldByName('nome_fantasia').Value;
      Dados2['cnae_principal_id'] := SQL2.Query.FieldByName('cnae_principal_id').Value;
      Dados2['arquivo_imagem_url'] := SQL2.Query.FieldByName('arquivo_imagem_url').Value;
      Dados2['arquivo_imagem_raw'] := SQL2.Query.FieldByName('arquivo_imagem_raw').Value;
      Dados2['endereco'] := SQL2.Query.FieldByName('endereco').Value;
      Dados2['contato'] := SQL2.Query.FieldByName('contato').Value;
      Dados2['email'] := SQL2.Query.FieldByName('email').Value;
      Dados2['sincronizado'] := SQL2.Query.FieldByName('sincronizado').Value;
      Dados2['data_insercao'] := SQL2.Query.FieldByName('data_insercao').Value;
      Dados2['data_edicao'] := SQL2.Query.FieldByName('data_edicao').Value;
      Showmessage(Query2.Insert('app_empresa', Dados2));
    finally
      FreeAndNil(Dados2);
      FreeAndNil(SQL2);
    end;

  finally
    FreeAndNil(DB);
  end;
end;

end.
